---
title: "Insights from the Initial Compromise Phase"
date: 2025-02-20 00:00:01 -0700
categories: [Red Teaming]
---

# Introduction

<br> 
The "Initial Compromise" phase is one of the most crucial stages of any red team engagement. It’s where the first foothold is established through a mix of technical exploits and social engineering. In this post, I’ll guide you through key aspects of this phase and provide practical demos that clearly demonstrate the concepts. All examples use placeholder domains and resources to keep things generic and reusable.

> **Disclaimer** : This post is for educational purposes only. Always obtain proper authorization before conducting any security testing.
{: .prompt-warning }
<br>

# Password Spraying
Password spraying targets common passwords across multiple accounts without triggering account lockouts. The goal here to highlight potential users who rely on weak and easily guessable passwords. Users often pick patterns like MonthYear, SeasonYear, or even common phrases like "iloveyou"  which attackers can exploit with minimal attempts.

Two excellent tools for password spraying against Office 365, Exchange, and Gmail are **MailSniper** and **SprayingToolkit**.
<br>

#### Using MailSniper (OWA):

import MailSniper and execute the password spray:
```zsh
Import-Module /path/to/MailSniper.ps1
Invoke-PasswordSprayOWA -ExchHostname mail.example-domain.com -UserList ./usernames. \
txt -Password "iloveyou"
```

#### Using SprayingToolkit (EAS - Exchange ActiveSync):

SprayingToolkit can target the Exchange ActiveSync (EAS) service, often overlooked in security configurations.
```zsh
python3 sprayingtoolkit.py --module eas --url \
https://mail.example-domain.com/Microsoft-Server-ActiveSync --userlist usernames.txt \
--password "Winter2024"
```

#### Using SprayingToolkit (Gmail):

You can also target Gmail accounts using IMAP or SMTP modules:
```zsh
python3 sprayingtoolkit.py --module imap --url imap.gmail.com --userlist usernames.txt --password "Summer2008"
```

## What This Demonstrates:

You might have noticed that the purpose here isn’t to brute force accounts but to demonstrate how some users may rely on weak passwords. This highlights potential security risks rather than overwhelming the system with excessive login attempts.
<br>

# Internal Phishing
With valid credentials in hand, attackers can craft convincing internal emails that recipients are more likely to trust.

This include creating a Malicious Document with VBA Macros:

In Word, go to View > Macros > Create and name the macro AutoOpen.








## 3. Spoofy
**What It Does:**  
A tool for assessing domain spoofability based on SPF and DMARC records.

**How to Use:**  
```bash
python3 spoofy.py -d target-domain.com -o stdout
```

## 4. Amass
**What It Does:**  
A reconnaissance tool for mapping a domain's attack surface using DNS enumeration.

**How to Use:**  
```bash
amass enum -d target-domain.com
```

## 5. Sublist3r
**What It Does:**  
A Python-based tool for discovering subdomains using search engines and brute force.

**How to Use:**  
```bash
python3 sublist3r.py -d target-domain.com
```

## 6. MailSniper
**What It Does:**  
A tool for testing password spraying attacks against Office 365 and Exchange services, allowing attackers to check for valid credentials.

**How to Use:**  
```powershell
Import-Module .\MailSniper.ps1
Invoke-SprayOWA -UserList users.txt -Password Password123 -Domain mail.target.com
```

## 7. SprayingToolkit
**What It Does:**  
A tool designed for performing password spraying attacks on various services, including Office 365.

**How to Use:**  
```powershell
Invoke-PasswordSprayO365 -Users users.txt -Password Password123!
```

## 8. Hunter.io
**What It Does:**  
An online service that gathers email addresses associated with a given domain for reconnaissance and social engineering.

**How to Use:**  
Visit [Hunter.io](https://hunter.io) and input a domain to retrieve email addresses and associated details.

## 9. Dig (Linux DNS Tool)
**What It Does:**  
A built-in Linux tool for querying DNS records, including MX, A, and TXT records.

**How to Use:**  
```bash
dig ANY target-domain.com
dig TXT target-domain.com
```

## 10. WhatWeb
**What It Does:**  
A reconnaissance tool that fingerprints web technologies, detecting CMS platforms, web servers, and security mechanisms.

**How to Use:**  
```bash
whatweb https://target-domain.com
```

## 11. o365enum
**What It Does:**  
A tool used for enumerating valid Office 365 email addresses by analyzing responses from login pages.

**How to Use:**  
```bash
python3 o365enum.py -d target-domain.com -u userlist.txt
```

## 12. Wireshark
**What It Does:**  
A network packet analyzer used to capture and inspect traffic for reconnaissance and troubleshooting.

**How to Use:**  
```bash
wireshark -k -i eth0
```

## 13. ProxyLogon & ProxyShell Exploit Tools
**What They Do:**  
Exploit known vulnerabilities in Microsoft Exchange to gain remote access.

**How to Check if a Target is Vulnerable:**  
```bash
nmap -p 443 --script http-vuln-cve2021-26855 target-ip
```

## 14. Nmap
**What It Does:**  
A network scanning tool used to identify open ports, running services, and potential vulnerabilities.

**How to Use:**  
```bash
nmap -A -T4 target-ip
```

## 15. SecurityTrails
**What It Does:**  
An online service for querying domain intelligence, subdomains, historical DNS records, and leaked credentials.

**How to Use:**  
Visit [SecurityTrails](https://securitytrails.com) and search for a domain to analyze its data footprint.
```